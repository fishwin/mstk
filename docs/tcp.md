### 1. tcp与udp区别，udp优点，适用场景



### 2. Tcp 三次握手过程及中间状态

+ 执行流程图

  ![](../images/sanciwoshou.png)

  + 过程描述
    + 客户端向服务端发送SYN=1（同步位），ACK=0（确认位），seq=x（随机序号）的包，并进入SYN_SENT状态（TCP规定报文段SYN=1且ACK=0表明这是一个请求建立链接的报文，不能携带数据）
    + 服务端收到连接请求后向客户端发送SYN=1（同步位），ACK=1（确认位），seq=y（序号），ack=x+1（确认号）,并进入SYN_RECV状态（TCP规定SYN=1且ACK=1的报文段为同意建立链接的响应报文，不能携带数据）
    + 客户端收到响应报文后，向服务端回复确认ACK=1（确认位），seq=x+1（序号），ack=y+1（确认号），客户端进入ESTABLISHED状态（这个ACK报文可以携带数据，如果不携带数据则不消耗序号）
    + 服务端进入ESTABLISHED状态

### 3. TCP为什么需要三次握手

+ **防止过期的连接请求发送到服务端，造成错误**

  比如客户端向服务端发送一条连接请求，但由于网络等原因，服务端一直没有回应SYN+ACK响应报文，这时客户端多次重试发送连接请求，直到服务端回复SYN+ACK报文，一段时间后，网络恢复，客户端的连接请求全部到达服务端，如果采用“两次握手”则服务端一旦收到连接请求就回复SYN+ACK报文进行连接建立，就会建立很多条连接，但是客户端目的只是建立一条连接，这样必然造成了资源浪费。所以当服务端收到连接请求后，还需要让客户端确认一下，让客户端决定建立哪个连接。

+ **初始化并交换序列号**

  序列号发挥着非常重要的作用

  + 对数据包进行**去重**
  + 超时**重传**（ack=n表示前n个数据包已接收成功）
  + 接收方对数据包进行**排序**

### 4. TCP半连接队列

+ 服务端收到客户端FIN包后，会回复FIN+ACK报文，并进入SYN_RECV状态，此时双方并没有完全建立链接，服务器会把这种状态的连接放到一个队列中，这个队列称为半连接队列。
+ 当服务端回复FIN+ACK报文后，未收到客户端的ACK，那么服务端会重试几次，如果还不能收到，则将这个链接从半连接队列中删除。

### 5. 三次握手过程中可以携带数据吗

第一次和第二次不可以携带数据，第三次可以携带数据，如果携带则消耗序列号，如果不携带则不消耗序列号。

### 6. SYN洪泛攻击

+ 概念：攻击者向服务器发送大量SYN包，服务端回复SYN+ACK后，攻击者不回复ACK。由于服务端会将这样的链接请求放入半连接队列中，当这种请求非常多时，服务器资源就会耗尽，无法响应正常的连接请求，甚至可能导致宕机。
+ 防范
  + 缩短半连接超时时间
  + 预警并屏蔽重复IP的大量SYN请求
  + SYN cookies（使攻击者不能伪造，并在服务端验证）
  + 增加最大半连接数

### 4. TCP四次挥手过程

+ 执行流程图

  ![](../images/sicihuishou.png)

  + 执行过程
    + 客户端向服务端发送FIN报文（FIN=1，seq=u），并进入FIN_WAIT_1状态
    + 服务端收到FIN报文后，向客户端回复确认报文（ACK=1,seq=v,ack=u+1），并进入到CLOSE_WAIT状态
    + 当前处于半关闭状态，客户端不能向服务端发送数据报文，但是服务端可以向客户端发送数据报文
    + 服务端向客户端发送FIN报文(FIN=1,ACK=1,seq=w,ack=u+1),并进入到LAST_ACK状态
    + 客户端收到FIN报文后，向服务端回复确认报文（ACK=1,seq=u+1,ack=w+1）并进入到TIME_WAIT状态
    + 服务端收到之后进入到CLOSED状态
    + 客户端等待2MSL（MSL表示最大报文生存时间，任何报文超过这个时间都会被丢弃）后也进入到CLOSED状态

### 5. 为什么TCP断开链接需要4次挥手





### 6. CLOSE_WAIT原因



### 7. TIME_WAIT原因，为什么要等待2MSL



### 7. 单点登录，tcp粘包



### 8. 停等协议



### 9. 滑动窗口



### 8. 出现很多TIME_WAIT为什么？



### 9. udp的头部



### 10. tcp的头部



### 11. tcp为什么是可靠的传输，怎么保证的



### 12.  tcp/ip 流量控制和拥塞控制



### 13. tcp怎么找到哪个套接字



### 14. 讲讲ping命令，用到了那些协议，执行过程



### 15. 什么是连接的半打开，半关闭状态



### 16. ARP协议



### 17. OSI七层网络协议



### 18. TCP/IP协议



### 19. *客户端在建立异常中发现很多connect reset by peer,你觉得问题出在哪？*



### 20. **客户端不断进行请求链接会怎样？DDos(Distributed Denial of Service)攻击？**如何预防DDos



### 21. TCP四次挥手中出现close_wait的原因？



### 22. 多播如何实现



### 23. 服务器最大连接数？TCP四元组



### 24. TLS/SSL协议如何保证信息安全





















